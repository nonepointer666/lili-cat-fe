{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport { getChatMsg } from '../../../api/index.js';\nexport default defineComponent({\n    data() {\n        return {\n            inputMessage: \"\",\n            chatList: [] // 聊天记录\n        };\n    },\n    methods: {\n        // 发送消息\n        sendMessage() {\n            if (!this.inputMessage.trim()) {\n                uni.showToast({\n                    title: \"消息不能为空\",\n                    icon: \"none\"\n                });\n                return null;\n            }\n            // 将用户消息添加到聊天记录\n            this.chatList.push({ role: \"user\", content: this.inputMessage });\n            this.inputMessage = \"\"; // 清空输入框\n            // 添加“思考中...”状态\n            this.chatList.push({ role: \"bot\", content: \"\", thinking: true });\n            // 调用接口获取回复\n            this.getBotReply();\n        },\n        // 调用接口获取回复\n        getBotReply() {\n            var _a, _b;\n            return __awaiter(this, void 0, void 0, function* () {\n                try {\n                    const response = yield getChatMsg(new UTSJSONObject({\n                        content: (_a = this.chatList[this.chatList.length - 2]) === null || _a === void 0 ? void 0 : _a.content\n                    }));\n                    if (response) {\n                        // 假设接口返回的数据在 response.data 中\n                        const botMessage = ((_b = response.choices[0]) === null || _b === void 0 ? void 0 : _b.message.content) || \"我不知道该说什么\";\n                        // 更新“思考中...”状态为实际回复\n                        this.chatList[this.chatList.length - 1] = {\n                            role: \"bot\",\n                            content: botMessage,\n                            thinking: false\n                        };\n                    }\n                    else {\n                        this.chatList[this.chatList.length - 1] = {\n                            role: \"bot\",\n                            content: \"请求失败，请重试\",\n                            thinking: false\n                        };\n                    }\n                }\n                catch (error) {\n                    this.chatList[this.chatList.length - 1] = {\n                        role: \"bot\",\n                        content: \"网络错误，请检查网络连接\",\n                        thinking: false\n                    };\n                    uni.__f__('error', 'at pages/views/chat/index.uvue:90', \"请求失败：\", error);\n                }\n            });\n        }\n    }\n});\n//# sourceMappingURL=D:/code/lili-cat-fe/pages/views/chat/index.uvue?vue&type=script&lang.uts.js.map","references":["D:/code/lili-cat-fe/api/index.js"],"uniExtApis":["uni.showToast","uni.__f__"],"map":"{\"version\":3,\"file\":\"index.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"index.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";;AACA,OAAO,EAAE,UAAU,EAAE,MAAM,uBAAuB,CAAA;AAElD,+BAAe;IACb,IAAI;QACF,OAAO;YACL,YAAY,EAAE,EAAE;YAChB,QAAQ,EAAE,EAAE,CAAC,OAAO;SACrB,CAAC;IACJ,CAAC;IACD,OAAO,EAAE;QACP,OAAO;QACP,WAAW;YACT,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE;gBAC7B,GAAG,CAAC,SAAS,CAAC;oBACZ,KAAK,EAAE,QAAQ;oBACf,IAAI,EAAE,MAAM;iBACb,CAAC,CAAC;gBACH,YAAO;aACR;YAED,eAAe;YACf,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC;YACjE,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,CAAC,QAAQ;YAEhC,eAAe;YACf,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;YAEjE,WAAW;YACX,IAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC;QAED,WAAW;QACL,WAAW;;;gBACf,IAAI;oBACL,MAAM,QAAQ,GAAG,MAAM,UAAU,mBAAC;wBACpC,OAAO,EAAE,MAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,0CAAE,OAAO;qBACzD,EAAC,CAAA;oBAEI,IAAI,QAAQ,EAAE;wBACZ,6BAA6B;wBAC7B,MAAM,UAAU,GAAG,CAAA,MAAA,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,0CAAE,OAAO,CAAC,OAAO,KAAI,UAAU,CAAC;wBAEtE,oBAAoB;wBACpB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG;4BACxC,IAAI,EAAE,KAAK;4BACX,OAAO,EAAE,UAAU;4BACnB,QAAQ,EAAE,KAAK;yBAChB,CAAC;qBACH;yBAAM;wBACL,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG;4BACxC,IAAI,EAAE,KAAK;4BACX,OAAO,EAAE,UAAU;4BACnB,QAAQ,EAAE,KAAK;yBAChB,CAAC;qBACH;iBACF;gBAAC,OAAO,KAAK,EAAE;oBACd,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG;wBACxC,IAAI,EAAE,KAAK;wBACX,OAAO,EAAE,cAAc;wBACvB,QAAQ,EAAE,KAAK;qBAChB,CAAC;oBACF,GAAG,CAAC,KAAK,CAAC,OAAO,EAAC,mCAAmC,EAAC,OAAO,EAAE,KAAK,CAAC,CAAC;iBACvE;;SACF;KACF;CACF,EAAC\"}"}
